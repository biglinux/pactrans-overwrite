pkgname=pactrans-overwrite
pkgver=0.11.1
pkgrel=1

pkgdesc='Modification of pactrans that belongs to the pacutils package, including the overwrite option'
depends='pacutils'
url='https://github.com/bigbruno/pactrans-overwrite'
arch=('x86_64')
license=('MIT')

depends=('pacman')
makedepends=('git')

source=("git+https://github.com/bigbruno/pactrans-overwrite.git")
sha1sums=('SKIP')

build() {
  mkdir -p /var/cache/manjaro-arm-tools/pkg/pkg-cache/
  cd pactrans-overwrite
  make PREFIX=/usr/share/biglinux/pactrans CFLAGS="$CFLAGS $LDFLAGS" SYSCONFDIR=/etc LOCALSTATEDIR=/var
}

check() {
  mkdir -p /var/cache/manjaro-arm-tools/pkg/pkg-cache/
  cd pactrans-overwrite
  make check
}

package() {
  cd pactrans-overwrite
  make DESTDIR="$pkgdir" PREFIX=/usr/share/biglinux/pactrans install
  install -Dm644 COPYING "$pkgdir"/usr/share/licenses/"$pkgname"/COPYING
  mkdir -p "$pkgdir"/usr/bin
  echo '#!/usr/bin/env bash

LD_LIBRARY_PATH=/usr/share/biglinux/pactrans/lib/ /usr/share/biglinux/pactrans/bin/pactrans $@' > "$pkgdir"/usr/bin/pactrans-overwrite
}
